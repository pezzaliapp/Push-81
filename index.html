<!DOCTYPE html><html lang="it"><head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover">
<meta name="theme-color" content="#0b1022"><meta name="apple-mobile-web-app-title" content="PUSH-81">
<meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<title>PUSH-81 ‚Äî Puzzle Arcade (PWA)</title>
<meta name="description" content="PUSH-81: iPhone-friendly. Audio 8-bit, CRT, palette retr√≤ (cambio colori), perfect moves, selettore livelli.">
<link rel="manifest" href="manifest.webmanifest"><link rel="icon" sizes="192x192" href="icons/icon-192.png"><link rel="apple-touch-icon" href="icons/icon-192.png">
<style>
:root{--bg:#0b1022;--panel:#0f1734;--ink:#e8f0ff;--muted:#98a7c7;--accent:#29f07a;--accent2:#00d1ff;--border:#1b2550;--btn:#141d3d;--goal:#00d1ff;--box:#ffc14d;--boxGoal:#2bf089}
*{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
html,body{height:100%;margin:0;background:var(--bg);color:var(--ink);font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial}
body{touch-action:manipulation;-webkit-user-select:none;user-select:none;-webkit-touch-callout:none}
header{padding:10px 14px calc(10px + env(safe-area-inset-top));border-bottom:1px solid var(--border);background:linear-gradient(180deg,#0d1636,#0a1230)}
header .brand{display:flex;gap:10px;align-items:center}
.crt{position:relative;overflow:hidden}
.crt:before{content:"";position:absolute;inset:-2px;pointer-events:none;background:radial-gradient(ellipse at center, rgba(0,0,0,.0) 60%, rgba(0,0,0,.35) 100%),repeating-linear-gradient(0deg, rgba(255,255,255,.05) 0px, rgba(255,255,255,.05) 1px, transparent 2px, transparent 3px);mix-blend-mode:overlay;filter:contrast(1.05) saturate(1.1)}
.crt-boost canvas{filter:contrast(1.25) saturate(1.25) brightness(1.05) drop-shadow(0 0 8px rgba(41,240,122,.25))}
main{display:grid;grid-template-columns:1fr;gap:12px;padding:12px;max-width:980px;margin:0 auto 88px}
.hud{display:flex;gap:8px;flex-wrap:wrap;align-items:center;justify-content:space-between;background:var(--panel);border:1px solid var(--border);padding:8px 10px;border-radius:10px}
.pill{background:var(--btn);border:1px solid var(--border);padding:6px 10px;border-radius:999px;font-weight:600}
.btn{cursor:pointer;background:var(--btn);border:1px solid var(--border);padding:10px 14px;border-radius:12px}
.btn.primary{border-color:#1c8550;box-shadow:0 0 0 1px rgba(41,240,122,.1) inset}
.grid-wrap{display:grid;place-items:center;background:var(--panel);border:1px solid var(--border);border-radius:12px;padding:10px}
canvas{width:100%;max-width:560px;aspect-ratio:1/1;image-rendering:pixelated;touch-action:none;border-radius:10px;border:1px solid var(--border);background:#000}
.muted{color:var(--muted)}footer{opacity:.9;padding:20px;text-align:center;color:var(--muted)}
.link{color:var(--accent2);text-decoration:none}.link:hover{text-decoration:underline}
.settings{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
select{background:var(--btn);color:var(--ink);border:1px solid var(--border);border-radius:8px;padding:6px 10px}
/* Sticky bottom controls */
.sticky-controls{position:fixed;left:0;right:0;bottom:0;padding:10px 12px calc(12px + env(safe-area-inset-bottom));background:rgba(8,12,30,.92);backdrop-filter:saturate(1.2) blur(6px);border-top:1px solid var(--border);display:grid;grid-template-columns:1fr auto 1fr;gap:10px;align-items:center}
.dpad{display:grid;grid-template-columns:repeat(3,1fr);grid-template-rows:repeat(2,1fr);gap:10px;justify-items:center;align-items:center;min-width:210px}
.dpad .btn{width:60px;height:60px;min-width:60px;min-height:60px;border-radius:16px;display:grid;place-items:center;border:2px solid #2a3570;background:#0e1633}
.dpad .btn:active{transform:translateY(1px);filter:brightness(1.1)}
.dpad svg{width:26px;height:26px;display:block}
.center-actions{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
.center-actions .btn{height:44px;border-radius:10px}
.right-actions{display:flex;gap:8px;justify-content:flex-end;flex-wrap:wrap}
.quickPalette{height:44px;border-radius:10px}
/* tiny phones */
@media (max-width:380px){
 .dpad .btn{width:52px;height:52px}
 .dpad svg{width:22px;height:22px}
 .quickPalette{font-size:14px;padding:8px 10px}
}
@media (min-width:860px){main{grid-template-columns:1fr 320px}.side{align-self:start;position:sticky;top:10px;height:max-content}}
</style>
</head>
<body class="crt crt-boost">
<header><div class="brand"><img src="icons/icon-192.png" width="28" height="28" alt="PUSH-81"><b>PUSH-81</b><span class="muted">‚Äî iPhone friendly</span></div></header>

<main>
  <section class="grid-wrap">
    <canvas id="game" width="480" height="480" aria-label="Scacchiera di gioco"></canvas>
    <div class="hud" role="group" aria-label="Pannello di controllo">
      <div class="settings">
        <span class="pill">Livello: <span id="levelNo">1</span>/<span id="levelMax">‚Äî</span></span>
        <label class="pill" style="display:flex;gap:6px;align-items:center">Vai a <select id="levelSelect"></select></label>
        <span class="pill">Mosse: <span id="moves">0</span></span>
        <span class="pill">Record: <span id="best">‚Äî</span></span>
        <span class="pill">Target: <span id="target">‚Äî</span></span>
        <span id="perfectBadge" class="pill" style="display:none">‚≠ê Perfect!</span>
        <label class="pill" style="display:flex;gap:6px;align-items:center"><input id="soundToggle" type="checkbox" checked>Audio</label>
        <label class="pill" style="display:flex;gap:6px;align-items:center"><input id="crtToggle" type="checkbox" checked>CRT+</label>
        <label class="pill" style="display:flex;gap:6px;align-items:center">Palette
          <select id="palette"><option value="classic">Classic</option><option value="phosphor">Verde fosforo</option><option value="amber">Ambra</option><option value="ice">Azzurro ghiaccio</option></select>
        </label>
      </div>
      <div>
        <button id="btnUndo" class="btn" title="Annulla (Z)">‚Ü∂ Undo</button>
        <button id="btnReset" class="btn" title="Reset (R)">‚ü≤ Reset</button>
        <button id="btnPrev" class="btn" title="Precedente (J)">‚ü∏</button>
        <button id="btnNext" class="btn primary" title="Successivo (K)">‚üπ</button>
      </div>
    </div>
  </section>
  <aside class="side"><div class="hud" style="display:block">
    <h3 style="margin:6px 0 4px">Come si gioca</h3>
    <p class="muted" style="margin:0 0 8px">Spingi le casse <b>$</b> sui bersagli <b>.</b>. Chiudi a ‚â§ <b>Target</b> per ‚≠ê Perfect. Cambia colori dal bottone ‚Äúüé® Palette‚Äù.</p>
  </div></aside>
</main>

<!-- Sticky controls -->
<nav class="sticky-controls" aria-label="Controlli touch">
  <div class="dpad">
    <button class="btn" data-dir="up" aria-label="Su"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 15l6-6 6 6"/></svg></button>
    <button class="btn" data-dir="left" aria-label="Sinistra"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M15 6l-6 6 6 6"/></svg></button>
    <button class="btn" data-dir="right" aria-label="Destra"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 6l6 6-6 6"/></svg></button>
    <div></div>
    <button class="btn" data-dir="down" aria-label="Gi√π"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 9l-6 6-6-6"/></svg></button>
    <div></div>
  </div>
  <div class="center-actions">
    <button class="btn" data-dir="reset" aria-label="Reset">‚ü≤ Reset</button>
    <button class="btn" data-dir="undo" aria-label="Undo">‚Ü∂ Undo</button>
  </div>
  <div class="right-actions">
    <button class="btn quickPalette" id="btnPalette" aria-label="Palette">üé® Palette</button>
    <button class="btn" id="btnShare" aria-label="Condividi">‚¨ÜÔ∏é Share</button>
    <button class="btn" id="btnA2HS" aria-label="Aggiungi a Home">Ôºã Home</button>
  </div>
</nav>

<footer>¬© 2025 pezzaliAPP ‚Äî MIT ‚Ä¢ PWA ‚Ä¢ iPhone-friendly ‚Ä¢ Audio 8-bit ‚Ä¢ CRT ‚Ä¢ Palette retr√≤</footer>

<script src="app.js"></script>
<script>if('serviceWorker' in navigator){addEventListener('load',()=>navigator.serviceWorker.register('service-worker.js'))}</script>
</body></html>
